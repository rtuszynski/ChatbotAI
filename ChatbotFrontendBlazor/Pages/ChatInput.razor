@using ChatbotFrontendBlazor.Models
@using ChatbotFrontendBlazor.Services
@inject ChatService ChatService

<div class="container mt-4">
    <h3 class="text-primary">Send a Message</h3>
    <EditForm Model="newMessage" OnValidSubmit="SendMessage">
        <DataAnnotationsValidator />

        <div class="form-group">
            <InputText class="form-control" @bind-Value="newMessage.UserMessage" placeholder="Your message" />
            <ValidationMessage For="@(() => newMessage.UserMessage)" class="text-danger" />
        </div>
        <button class="btn btn-primary" type="submit">Send</button>
    </EditForm>
</div>

@code {
    private ChatMessage newMessage = new ChatMessage();

    [Parameter] public EventCallback OnMessageSent { get; set; }

    private async Task SendMessage()
    {
        await ChatService.AddMessageAsync(newMessage);
        await OnMessageSent.InvokeAsync();

        newMessage = new ChatMessage();
    }
}